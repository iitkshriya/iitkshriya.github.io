<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Minesweeper</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #ece9e6, #ffffff);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
    }

    #start-screen, #game-screen {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    #start-screen.active, #game-screen.active {
      display: flex;
    }

    #start-screen img {
      margin-bottom: 10px;
      animation: pop 1s ease-in-out infinite alternate;
    }

    #start-screen .tagline {
      font-size: 18px;
      font-style: italic;
      color: #555;
    }

    @keyframes pop {
      from { transform: scale(1); }
      to { transform: scale(1.1); }
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(33, 150, 243, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(33, 150, 243, 0); }
      100% { box-shadow: 0 0 0 0 rgba(33, 150, 243, 0); }
    }

    button {
      padding: 10px 16px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      background-color: #2196f3;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #0b7dda;
    }

    #start-screen button {
      animation: pulse 2s infinite;
    }

    #game-container {
      display: grid;
      grid-template-columns: repeat(10, 30px);
      gap: 2px;
      margin-top: 10px;
    }

    .cell {
      width: 30px;
      height: 30px;
      background-color: #4caf50;
      color: #fff;
      font-weight: bold;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      font-size: 16px;
      user-select: none;
    }

    .cell.revealed {
      background-color: #dcdcdc;
      color: #333;
      box-shadow: none;
      cursor: default;
    }

    .cell.bomb {
      background-color: #e74c3c;
      color: white;
    }

    .info {
      font-size: 18px;
      display: flex;
      justify-content: space-between;
      width: 300px;
    }

    #popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 20px 30px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      z-index: 100;
      text-align: center;
      display: none;
    }

    #popup h2 {
      margin-bottom: 10px;
    }

    #popup button {
      margin-top: 10px;
      background-color: #4caf50;
    }

    #sound-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 14px;
      background-color: #f57c00;
    }
  </style>
</head>
<body>

<!-- üéµ Background Music -->
<audio id="bg-music" loop autoplay>
  <source src="https://www.bensound.com/bensound-music/bensound-creativeminds.mp3" type="audio/mpeg">
</audio>

<!-- üîä Click Sound -->
<audio id="click-sound">
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_2c535f3e14.mp3" type="audio/mpeg">
</audio>

<!-- Start Screen -->
<div id="start-screen" class="active">
  <img src="https://upload.wikimedia.org/wikipedia/commons/2/29/Minesweeper_Icon.svg" width="100" alt="Minesweeper Icon">
  <h1>Minesweeper</h1>
  <p class="tagline">‚ö†Ô∏è Avoid the bombs, clear the field!</p>
  <button onclick="startGame()">Start Game</button>
</div>

<!-- Game Screen -->
<div id="game-screen">
  <button id="sound-toggle" onclick="toggleSound()">üîä Sound: ON</button>
  <div class="info">
    <span>Time: <span id="timer">0</span>s</span>
    <span>Flags: <span id="flags-left">10</span></span>
  </div>
  <div id="game-container"></div>
  <button onclick="resetGame()">Reset</button>
</div>

<!-- Popup -->
<div id="popup">
  <h2 id="popup-message"></h2>
  <button onclick="closePopup()">OK</button>
</div>

<script>
  const gridSize = 10;
  let bombs = [], revealedCount = 0, totalSafeCells = gridSize * gridSize - 10, flagsLeft = 10;
  let timer = 0, timerInterval, gameOver = false;
  let soundOn = true;

  const bgMusic = document.getElementById("bg-music");
  const clickSound = document.getElementById("click-sound");
  const soundBtn = document.getElementById("sound-toggle");

  function showPopup(message) {
    document.getElementById("popup-message").textContent = message;
    document.getElementById("popup").style.display = "block";
  }

  function closePopup() {
    document.getElementById("popup").style.display = "none";
  }

  function toggleSound() {
    soundOn = !soundOn;
    bgMusic.muted = !soundOn;
    soundBtn.textContent = soundOn ? "üîä Sound: ON" : "üîá Sound: OFF";
  }

  function startGame() {
    document.getElementById('start-screen').classList.remove('active');
    document.getElementById('game-screen').classList.add('active');
    resetGame();
    bgMusic.play();
  }

  function startTimer() {
    timer = 0;
    clearInterval(timerInterval);
    timerInterval = setInterval(() => {
      timer++;
      document.getElementById("timer").innerText = timer;
    }, 1000);
  }

  function createBombs() {
    bombs = [];
    const set = new Set();
    while (set.size < 10) {
      const x = Math.floor(Math.random() * gridSize);
      const y = Math.floor(Math.random() * gridSize);
      set.add(`${x},${y}`);
    }
    bombs = Array.from(set);
  }

  function isBomb(x, y) {
    return bombs.includes(`${x},${y}`);
  }

  function countAdjacentBombs(x, y) {
    if (isBomb(x, y)) return -1;
    let count = 0;
    for (let dx = -1; dx <= 1; dx++) {
      for (let dy = -1; dy <= 1; dy++) {
        if (dx === 0 && dy === 0) continue;
        const nx = x + dx, ny = y + dy;
        if (nx >= 0 && nx < gridSize && ny >= 0 && ny < gridSize) {
          if (isBomb(nx, ny)) count++;
        }
      }
    }
    return count;
  }

  function revealCell(cell, value) {
    if (cell.classList.contains("revealed") || cell.dataset.flagged === "true") return;

    cell.classList.add("revealed");
    cell.style.pointerEvents = "none";

    if (soundOn) {
      clickSound.currentTime = 0;
      clickSound.play();
    }

    if (value === "üí£") {
      cell.classList.add("bomb");
      cell.textContent = value;
      return;
    }

    cell.textContent = value === "0" ? "" : value;
    revealedCount++;

    if (revealedCount === totalSafeCells && !gameOver) {
      winGame();
    }
  }

  function revealEmptyArea(x, y) {
    const stack = [[x, y]];
    while (stack.length) {
      const [cx, cy] = stack.pop();
      const cell = document.getElementById(`${cx},${cy}`);
      if (!cell || cell.classList.contains("revealed") || cell.dataset.flagged === "true") continue;
      const value = cell.dataset.value;
      revealCell(cell, value);
      if (value === "0") {
        for (let dx = -1; dx <= 1; dx++) {
          for (let dy = -1; dy <= 1; dy++) {
            const nx = cx + dx, ny = cy + dy;
            if (nx >= 0 && nx < gridSize && ny >= 0 && ny < gridSize) {
              stack.push([nx, ny]);
            }
          }
        }
      }
    }
  }

  function renderGrid() {
    const container = document.getElementById("game-container");
    container.innerHTML = "";
    for (let y = 0; y < gridSize; y++) {
      for (let x = 0; x < gridSize; x++) {
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.id = `${x},${y}`;
        const val = isBomb(x, y) ? "üí£" : countAdjacentBombs(x, y);
        cell.dataset.value = val.toString();
        cell.dataset.flagged = "false";
        container.appendChild(cell);
      }
    }
  }

  document.addEventListener("click", function (e) {
    const cell = e.target;
    if (!cell.classList.contains("cell") || gameOver || cell.dataset.flagged === "true") return;

    const [x, y] = cell.id.split(",").map(Number);
    const value = cell.dataset.value;

    if (value === "üí£") {
      revealCell(cell, value);
      gameOver = true;
      clearInterval(timerInterval);
      document.querySelectorAll(".cell").forEach(c => revealCell(c, c.dataset.value));
      showPopup("üí• Game Over!");
      return;
    }

    if (value === "0") {
      revealEmptyArea(x, y);
    } else {
      revealCell(cell, value);
    }
  });

  document.addEventListener("contextmenu", function (e) {
    e.preventDefault();
    const cell = e.target;
    if (!cell.classList.contains("cell") || cell.classList.contains("revealed") || gameOver) return;

    const isFlagged = cell.dataset.flagged === "true";
    if (isFlagged) {
      cell.textContent = "";
      cell.dataset.flagged = "false";
      flagsLeft++;
    } else if (flagsLeft > 0) {
      cell.textContent = "üö©";
      cell.dataset.flagged = "true";
      flagsLeft--;
    }
    document.getElementById("flags-left").innerText = flagsLeft;
  });

  function winGame() {
    gameOver = true;
    clearInterval(timerInterval);
    showPopup("üèÜ You Win! Time: " + timer + "s");
  }

  function resetGame() {
    gameOver = false;
    revealedCount = 0;
    flagsLeft = 10;
    document.getElementById("timer").innerText = "0";
    document.getElementById("flags-left").innerText = flagsLeft;
    createBombs();
    renderGrid();
    startTimer();
    closePopup();
  }
</script>
</body>
</html>
